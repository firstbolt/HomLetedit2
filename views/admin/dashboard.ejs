<%- include('../partials/header') %>

<div class="container" style="padding: 2rem 0;">
    <div style="margin-bottom: 2rem;">
        <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem; color: #667eea;">ğŸ‘¨â€ğŸ’¼ Admin Dashboard</h1>
        <p style="color: rgba(255, 255, 255, 0.8);">Welcome to the HomLet administration panel</p>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-icon">ğŸ‘¥</span>
            <span class="stat-number"><%= typeof stats !== 'undefined' ? stats.clientsCount : 0 %></span>
            <span class="stat-label">Total Clients</span>
        </div>

        <div class="stat-card">
            <span class="stat-icon">ğŸ¢</span>
            <span class="stat-number"><%= typeof stats !== 'undefined' ? stats.agentsCount : 0 %></span>
            <span class="stat-label">Total Agents</span>
        </div>

        <div class="stat-card">
            <span class="stat-icon">ğŸ </span>
            <span class="stat-number"><%= typeof stats !== 'undefined' ? stats.propertiesCount : 0 %></span>
            <span class="stat-label">Total Properties</span>
        </div>

        <div class="stat-card">
            <span class="stat-icon">â³</span>
            <span class="stat-number"><%= typeof stats !== 'undefined' ? stats.pendingDeals : 0 %></span>
            <span class="stat-label">Pending Deals</span>
        </div>

        <div class="stat-card">
            <span class="stat-icon">ğŸ“</span>
            <span class="stat-number"><%= typeof stats !== 'undefined' ? stats.contactsCount : 0 %></span>
            <span class="stat-label">Contact Requests</span>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card mb-4">
        <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem; color: #667eea;">âš¡ Quick Actions</h2>
        <div class="grid grid-5">
            <a href="/admin/clients" class="btn btn-primary">ğŸ‘¥ Manage Clients</a>
            <a href="/admin/agents" class="btn btn-success">ğŸ¢ Manage Agents</a>
            <a href="/admin/properties" class="btn btn-secondary">ğŸ  View Properties</a>
            <a href="/admin/deals" class="btn btn-danger">ğŸ’¼ View Deals</a>
            <a href="/admin/contacts" class="btn btn-warning">ğŸ“ View Contacts</a>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="grid grid-3">
        <!-- Recent Clients -->
        <div class="card">
            <h3 style="font-size: 1.25rem; margin-bottom: 1rem; color: #667eea;">ğŸ‘¥ Recent Clients</h3>
            <% if (typeof recentClients !== 'undefined' && recentClients && recentClients.length > 0) { %>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <% recentClients.forEach(client => { %>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                            <div style="display: flex; align-items: center;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; margin-right: 1rem; color: white; font-weight: bold;">
                                    <%= client.fullName.charAt(0) %>
                                </div>
                                <div>
                                    <p style="font-weight: 600; color: #ffffff; margin: 0;"><%= client.fullName %></p>
                                    <p style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.7); margin: 0;"><%= client.email %></p>
                                </div>
                            </div>
                            <span style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.6);">
                                <%= new Date(client.createdAt).toLocaleDateString() %>
                            </span>
                        </div>
                    <% }); %>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <a href="/admin/clients" class="btn btn-sm btn-primary">View All Clients</a>
                </div>
            <% } else { %>
                <div style="text-align: center; padding: 2rem 0;">
                    <div style="color: rgba(255, 255, 255, 0.7);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ‘¥</div>
                        <p>No recent clients</p>
                    </div>
                </div>
            <% } %>
        </div>

        <!-- Recent Agents -->
        <div class="card">
            <h3 style="font-size: 1.25rem; margin-bottom: 1rem; color: #667eea;">ğŸ¢ Recent Agents</h3>
            <% if (typeof recentAgents !== 'undefined' && recentAgents && recentAgents.length > 0) { %>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <% recentAgents.forEach(agent => { %>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                            <div style="display: flex; align-items: center;">
                                <% if (agent.profilePicture) { %>
                                    <img src="/uploads/profiles/<%= agent.profilePicture %>" alt="<%= agent.fullName %>" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 1rem;">
                                <% } else { %>
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #51cf66, #40c057); display: flex; align-items: center; justify-content: center; margin-right: 1rem; color: white; font-weight: bold;">
                                        <%= agent.fullName.charAt(0) %>
                                    </div>
                                <% } %>
                                <div>
                                    <p style="font-weight: 600; color: #ffffff; margin: 0;"><%= agent.fullName %></p>
                                    <p style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.7); margin: 0;"><%= agent.email %></p>
                                    <p style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.7); margin: 0;">Commission: <%= agent.commission %>%</p>
                                </div>
                            </div>
                            <span style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.6);">
                                <%= new Date(agent.createdAt).toLocaleDateString() %>
                            </span>
                        </div>
                    <% }); %>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <a href="/admin/agents" class="btn btn-sm btn-success">View All Agents</a>
                </div>
            <% } else { %>
                <div style="text-align: center; padding: 2rem 0;">
                    <div style="color: rgba(255, 255, 255, 0.7);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ¢</div>
                        <p>No recent agents</p>
                    </div>
                </div>
            <% } %>
        </div>

        <!-- Recent Properties -->
        <div class="card">
            <h3 style="font-size: 1.25rem; margin-bottom: 1rem; color: #667eea;">ğŸ  Recent Properties</h3>
            <% if (typeof recentProperties !== 'undefined' && recentProperties && recentProperties.length > 0) { %>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <% recentProperties.forEach(property => { %>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                            <div>
                                <p style="font-weight: 600; color: #ffffff; margin: 0;"><%= property.title %></p>
                                <p style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.7); margin: 0;">by <%= property.agent.fullName %></p>
                                <p style="font-size: 0.875rem; color: #51cf66; margin: 0;">â‚¦<%= property.price.toLocaleString() %></p>
                            </div>
                            <span style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.6);">
                                <%= new Date(property.createdAt).toLocaleDateString() %>
                            </span>
                        </div>
                    <% }); %>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <a href="/admin/properties" class="btn btn-sm btn-secondary">View All Properties</a>
                </div>
            <% } else { %>
                <div style="text-align: center; padding: 2rem 0;">
                    <div style="color: rgba(255, 255, 255, 0.7);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ </div>
                        <p>No recent properties</p>
                    </div>
                </div>
            <% } %>
        </div>
    </div>

    <!-- System Status -->
    <div class="card text-center" style="margin-top: 2rem; background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));">
        <h3 style="font-size: 1.5rem; margin-bottom: 1rem; color: #667eea;">ğŸ–¥ï¸ System Status</h3>
        <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1.5rem;">HomLet platform is running smoothly</p>
        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
            <span style="background: rgba(81, 207, 102, 0.2); color: #51cf66; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem;">âœ… Database Connected</span>
            <span style="background: rgba(81, 207, 102, 0.2); color: #51cf66; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem;">âœ… Server Running</span>
            <span style="background: rgba(81, 207, 102, 0.2); color: #51cf66; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem;">âœ… All Systems Operational</span>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>